!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Xjs=t()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function e(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),n=new Uint8Array(16);function r(){if(!t)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(n)}var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function o(e){return"string"==typeof e&&i.test(e)}for(var s,a,c,l=[],u=0;u<256;++u)l.push((u+256).toString(16).substr(1));function d(e,t,n){var i=(e=e||{}).random||(e.rng||r)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var s=0;s<16;++s)t[n+s]=i[s];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!o(n))throw TypeError("Stringified UUID is invalid");return n}(i)}class f{}f.isSourcePlugin="undefined"!=typeof window&&window.external&&void 0!==window.external.GetConfiguration,f.isSourceProps="undefined"!=typeof window&&window.external&&void 0===window.external.GetConfiguration&&void 0!==window.external.GetViewId&&void 0!==window.external.GetViewId(),f.isExtension="undefined"!=typeof window&&window.external&&void 0===window.external.GetConfiguration&&void 0!==window.external.GetViewId&&void 0===window.external.GetViewId(),function(e){e.Local="local",e.Remote="remote",e.Proxy="proxy"}(s||(s={})),function(e){e.Extension="extension",e.Source="source",e.Shell="shell,"}(a||(a={})),function(e){e.None="none",e.Warning="warning",e.Debug="debug"}(c||(c={}));var h,p=new class{constructor(){this._asyncId=0,this._callbacks={}}getAsyncId(){return this._asyncId++}register(e,t){return new Promise((n,r)=>{const i=this.getAsyncId();t(Object.assign({asyncId:i},e));const o=setTimeout(()=>{delete this._callbacks[i],r(new Error(e.fn+" failed. Timeout error"))},6e4);this._callbacks[i]={callback:n,clean:()=>{clearTimeout(o),delete this._callbacks[i]}}})}isCallbackExisting(e){return this._callbacks.hasOwnProperty(e)}runCallback({asyncId:e,result:t}){if(this.isCallbackExisting(e)){const{callback:n,clean:r}=this._callbacks[e];n(t),r()}}};!function(e){e.ON="subscribe",e.OFF="unsubscribe"}(h||(h={}));var g="object"==typeof global&&global&&global.Object===Object&&global,y="object"==typeof self&&self&&self.Object===Object&&self,v=g||y||Function("return this")(),m=v.Symbol,b=Object.prototype,w=b.hasOwnProperty,x=b.toString,A=m?m.toStringTag:void 0;var P=Object.prototype.toString;var N=m?m.toStringTag:void 0;function O(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":N&&N in Object(e)?function(e){var t=w.call(e,A),n=e[A];try{e[A]=void 0;var r=!0}catch(e){}var i=x.call(e);return r&&(t?e[A]=n:delete e[A]),i}(e):function(e){return P.call(e)}(e)}var C=Array.isArray;function j(e){return null!=e&&"object"==typeof e}const T=e=>function(e){return"string"==typeof e||!C(e)&&j(e)&&"[object String]"==O(e)}(e)?JSON.parse(e):e;function k(e){return"symbol"==typeof e||j(e)&&"[object Symbol]"==O(e)}var S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,E=/^\w*$/;function I(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var _,V=v["__core-js_shared__"],F=(_=/[^.]+$/.exec(V&&V.keys&&V.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"";var M=Function.prototype.toString;var D=/^\[object .+?Constructor\]$/,R=Function.prototype,$=Object.prototype,G=R.toString,L=$.hasOwnProperty,B=RegExp("^"+G.call(L).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function J(e){return!(!I(e)||(t=e,F&&F in t))&&(function(e){if(!I(e))return!1;var t=O(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}(e)?B:D).test(function(e){if(null!=e){try{return M.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function z(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return J(n)?n:void 0}var U=z(Object,"create");var X=Object.prototype.hasOwnProperty;var Y=Object.prototype.hasOwnProperty;function q(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function H(e,t){return e===t||e!=e&&t!=t}function W(e,t){for(var n=e.length;n--;)if(H(e[n][0],t))return n;return-1}q.prototype.clear=function(){this.__data__=U?U(null):{},this.size=0},q.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},q.prototype.get=function(e){var t=this.__data__;if(U){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return X.call(t,e)?t[e]:void 0},q.prototype.has=function(e){var t=this.__data__;return U?void 0!==t[e]:Y.call(t,e)},q.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=U&&void 0===t?"__lodash_hash_undefined__":t,this};var Z=Array.prototype.splice;function K(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}K.prototype.clear=function(){this.__data__=[],this.size=0},K.prototype.delete=function(e){var t=this.__data__,n=W(t,e);return!(n<0)&&(n==t.length-1?t.pop():Z.call(t,n,1),--this.size,!0)},K.prototype.get=function(e){var t=this.__data__,n=W(t,e);return n<0?void 0:t[n][1]},K.prototype.has=function(e){return W(this.__data__,e)>-1},K.prototype.set=function(e,t){var n=this.__data__,r=W(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var Q=z(v,"Map");function ee(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}te.prototype.clear=function(){this.size=0,this.__data__={hash:new q,map:new(Q||K),string:new q}},te.prototype.delete=function(e){var t=ee(this,e).delete(e);return this.size-=t?1:0,t},te.prototype.get=function(e){return ee(this,e).get(e)},te.prototype.has=function(e){return ee(this,e).has(e)},te.prototype.set=function(e,t){var n=ee(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function ne(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(ne.Cache||te),n}ne.Cache=te;var re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ie=/\\(\\)?/g,oe=function(e){var t=ne(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(re,(function(e,n,r,i){t.push(r?i.replace(ie,"$1"):n||e)})),t}));var se=m?m.prototype:void 0,ae=se?se.toString:void 0;function ce(e){if("string"==typeof e)return e;if(C(e))return function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}(e,ce)+"";if(k(e))return ae?ae.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function le(e){return null==e?"":ce(e)}function ue(e,t){return C(e)?e:function(e,t){if(C(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!k(e))||(E.test(e)||!S.test(e)||null!=t&&e in Object(t))}(e,t)?[e]:oe(le(e))}function de(e){if("string"==typeof e||k(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function fe(e,t){for(var n=0,r=(t=ue(t,e)).length;null!=e&&n<r;)e=e[de(t[n++])];return n&&n==r?e:void 0}var he=function(){try{var e=z(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var pe=Object.prototype.hasOwnProperty;function ge(e,t,n){var r=e[t];pe.call(e,t)&&H(r,n)&&(void 0!==n||t in e)||function(e,t,n){"__proto__"==t&&he?he(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}(e,t,n)}var ye=/^(?:0|[1-9]\d*)$/;function ve(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ye.test(e))&&e>-1&&e%1==0&&e<t}function me(e,t,n,r){if(!I(e))return e;for(var i=-1,o=(t=ue(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var c=de(t[i]),l=n;if(i!=s){var u=a[c];void 0===(l=r?r(u,c,a):void 0)&&(l=I(u)?u:ve(t[i+1])?[]:{})}ge(a,c,l),a=a[c]}return e}function be(e,t){return null!=e&&t in Object(e)}function we(e){return j(e)&&"[object Arguments]"==O(e)}var xe=Object.prototype,Ae=xe.hasOwnProperty,Pe=xe.propertyIsEnumerable,Ne=we(function(){return arguments}())?we:function(e){return j(e)&&Ae.call(e,"callee")&&!Pe.call(e,"callee")};function Oe(e,t){return null!=e&&function(e,t,n){for(var r,i=-1,o=(t=ue(t,e)).length,s=!1;++i<o;){var a=de(t[i]);if(!(s=null!=e&&n(e,a)))break;e=e[a]}return s||++i!=o?s:!!(o=null==e?0:e.length)&&("number"==typeof(r=o)&&r>-1&&r%1==0&&r<=9007199254740991)&&ve(a,o)&&(C(e)||Ne(e))}(e,t,be)}function Ce(e,t){return function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=fe(e,s);n(a,s)&&me(o,ue(s,e),a)}return o}(e,t,(function(t,n){return Oe(e,n)}))}function je(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var Te=m?m.isConcatSpreadable:void 0;function ke(e){return C(e)||Ne(e)||!!(Te&&e&&e[Te])}function Se(e){return(null==e?0:e.length)?function e(t,n,r,i,o){var s=-1,a=t.length;for(r||(r=ke),o||(o=[]);++s<a;){var c=t[s];n>0&&r(c)?n>1?e(c,n-1,r,i,o):je(o,c):i||(o[o.length]=c)}return o}(e,1):[]}function Ee(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var Ie=Math.max;var _e=he?function(e,t){return he(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:function(e){return e},Ve=Date.now;var Fe,Me,De,Re=(Fe=_e,Me=0,De=0,function(){var e=Ve(),t=16-(e-De);if(De=e,t>0){if(++Me>=800)return arguments[0]}else Me=0;return Fe.apply(void 0,arguments)});var $e=function(e){return Re(function(e,t,n){return t=Ie(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=Ie(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),Ee(e,this,a)}}(e,void 0,Se),e+"")}((function(e,t){return null==e?{}:Ce(e,t)}));const Ge=e=>"event"===e;class Le{constructor({clientId:e,type:t,exec:n}){this.eventCallbacks={},this.proxy={clientEvents:{},getClientEvents:e=>(this.proxy.clientEvents.hasOwnProperty(e)||(this.proxy.clientEvents[e]={}),this.proxy.clientEvents[e]),registerEvent:(e,t,n)=>{this.proxy.getClientEvents(e)[t]=n},unregisterEvent(e,t){if(this.proxy.clientEvents.hasOwnProperty(e)){const n=this.proxy.getClientEvents(e);delete n[t],0===Object.keys(n).length&&delete this.proxy.clientEvents[e]}},emitEvent:(e,t)=>{Object.values(this.proxy.clientEvents).forEach(n=>{n.hasOwnProperty(e)&&n[e](t)})}},this.remote={eventCallbacks:{},registerEvent:(e,t)=>{this.remote.eventCallbacks[e]=t,this.sender({from:s.Remote,clientId:this.clientId,type:"event",action:h.ON,eventName:e})},unregisterEvent:e=>{this.eventCallbacks.hasOwnProperty(e)&&(delete this.eventCallbacks[e],this.sender({from:s.Remote,clientId:this.clientId,type:"event",action:h.OFF,eventName:e}))},emitEvent:(e,t)=>{this.remote.eventCallbacks.hasOwnProperty(e)&&this.remote.eventCallbacks[e](t)}},this.clientId=e,this.type=t,this.exec=n}setSender(e){this.sender=e}send(e){return p.register(e,this.sender)}receiveMessage(e){const t=T(e);if(this.isRemote()){if(Ge(t.type)){const{eventName:e,result:n}=t;return void this.remote.emitEvent(e,n)}return p.runCallback($e(t,["asyncId","result","from","clientId"]))}if(Ge(t.type))return t.action===h.ON?void this.proxy.registerEvent(t.clientId,t.eventName,e=>{this.sender({from:s.Proxy,clientId:t.clientId,type:"event",eventName:t.eventName,result:e})}):void this.proxy.unregisterEvent(t.clientId,t.eventName);this.processRequest($e(t,["clientId","asyncId","fn","args"]))}processRequest({clientId:t,asyncId:n,fn:r,args:i}){return e(this,void 0,void 0,(function*(){const e=yield this.exec(r,...i);this.sender({from:s.Proxy,clientId:t,asyncId:n,result:e})}))}isRemote(){return this.type===s.Remote}}const Be=(e,t)=>(...n)=>{e(...n),t&&t(...n)},Je=e=>{var t,n;if(n=typeof(t=e),null!=t&&("object"==n||"function"==n)&&0!==Object.keys(e).length)for(const t in e){const n=e[t];window[t]=Be(n,window[t])}};class ze{constructor(e){this._callbacks={},this.type=e,Je({OnAsyncCallback:(e,...t)=>{if("function"==typeof this._callbacks[e]){const n=t.map(e=>decodeURIComponent(e));this._callbacks[e](...n),delete this._callbacks[e]}}})}setRemote(e){this.remote=e}exec(e,...t){return new Promise((n,r)=>{if(this.isRemote())return this.remote.send({from:s.Remote,clientId:this.remote.clientId,fn:e,args:t}).then(n).catch(r);if(!window.external||!window.external[e]||!function(e){if(!I(e))return!1;var t=O(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}(window.external[e]))return void r(new Error(e+" is not a valid external call, or is not supported on the target environment."));const i=window.external[e](...t);if("number"==typeof(o=i)||j(o)&&"[object Number]"==O(o))return this._callbacks[i]=e=>{n(e)},i;var o;n(i)})}isRemote(){return this.type===s.Remote}}class Ue{constructor(e={type:s.Local}){this.type=s.Local,this.clientId=d(),Object.keys(e).forEach(t=>{this.hasOwnProperty(t)&&(this[t]=e[t])}),this.internal=new ze(this.type),[s.Remote,s.Proxy].includes(this.type)&&(this.remote=new Le({clientId:this.clientId,type:this.type,exec:this.internal.exec.bind(this.internal)}),this.remote.setSender(e.sendMessage),this.internal.setRemote(this.remote))}setConfigWindow(t){return e(this,void 0,void 0,(function*(){if(!f.isSourcePlugin)throw new Error("can only set configuration for the current item");let e=yield this.internal.exec("GetLocalPropertyAsync","prop:BrowserConfiguration"),n={};return""!==e&&"null"!==e||(e=yield this.internal.exec("GetConfiguration")),n=JSON.parse(e||"{}"),n.configUrl=t,yield this.internal.exec("SetBrowserProperty","Configuration",JSON.stringify(n)),!0}))}isLocal(){return this.type===s.Local}isProxy(){return this.type===s.Proxy}isRemote(){return this.type===s.Remote}}function Xe(e,t,n=!1){const r=new RegExp("\\${(\\w+)}","g");let i=r.exec(e),o=e;for(;i;){const[s,a]=i;void 0!==t[a]&&(o=o.replace(s,t[a]),n&&delete t[a]),i=r.exec(e)}return o}Ue.version="3.0.0-alpha.1";function Ye(e,t,n){return e.reduce((e,n,r)=>e.then(e=>t(e,n,r)),Promise.resolve(n))}function qe(e,t){return e(t={exports:{}},t.exports),t.exports}var He=qe((function(e,t){const n=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r="["+n+"][:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",i=new RegExp("^"+r+"$");t.isExist=function(e){return void 0!==e},t.isEmptyObject=function(e){return 0===Object.keys(e).length},t.merge=function(e,t,n){if(t){const r=Object.keys(t),i=r.length;for(let o=0;o<i;o++)e[r[o]]="strict"===n?[t[r[o]]]:t[r[o]]}},t.getValue=function(e){return t.isExist(e)?e:""},t.buildOptions=function(e,t,n){var r={};if(!e)return t;for(let i=0;i<n.length;i++)void 0!==e[n[i]]?r[n[i]]=e[n[i]]:r[n[i]]=t[n[i]];return r},t.isName=function(e){const t=i.exec(e);return!(null==t)},t.getAllMatches=function(e,t){const n=[];let r=t.exec(e);for(;r;){const i=[],o=r.length;for(let e=0;e<o;e++)i.push(r[e]);n.push(i),r=t.exec(e)}return n},t.nameRegexp=r}));He.isExist,He.isEmptyObject,He.merge,He.getValue,He.buildOptions,He.isName,He.getAllMatches,He.nameRegexp;const We=function(e,t){const n={};if(!(e.child&&!He.isEmptyObject(e.child)||e.attrsMap&&!He.isEmptyObject(e.attrsMap)))return He.isExist(e.val)?e.val:"";He.isExist(e.val)&&("string"!=typeof e.val||""!==e.val&&e.val!==t.cdataPositionChar)&&("strict"===t.arrayMode?n[t.textNodeName]=[e.val]:n[t.textNodeName]=e.val),He.merge(n,e.attrsMap,t.arrayMode);const r=Object.keys(e.child);for(let s=0;s<r.length;s++){var i=r[s];if(e.child[i]&&e.child[i].length>1)for(var o in n[i]=[],e.child[i])n[i].push(We(e.child[i][o],t));else if(!0===t.arrayMode){const r=We(e.child[i][0],t);n[i]="object"==typeof r?[r]:r}else"strict"===t.arrayMode?n[i]=[We(e.child[i][0],t)]:n[i]=We(e.child[i][0],t)}return n};var Ze={convertToJson:We},Ke=function(e,t,n){this.tagname=e,this.parent=t,this.child={},this.attrsMap={},this.val=n,this.addChild=function(e){Array.isArray(this.child[e.tagname])?this.child[e.tagname].push(e):this.child[e.tagname]=[e]}};const Qe=He.buildOptions;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,He.nameRegexp);!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const et={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",tagValueProcessor:function(e,t){return e},attrValueProcessor:function(e,t){return e},stopNodes:[]};var tt=et;const nt=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","stopNodes"];var rt=nt;function it(e,t,n){return t&&(n.trimValues&&(t=t.trim()),t=st(t=n.tagValueProcessor(t,e),n.parseNodeValue,n.parseTrueNumberOnly)),t}function ot(e,t){if(t.ignoreNameSpace){const t=e.split(":"),n="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=n+t[1])}return e}function st(e,t,n){if(t&&"string"==typeof e){let t;return""===e.trim()||isNaN(e)?t="true"===e||"false"!==e&&e:(-1!==e.indexOf("0x")?t=Number.parseInt(e,16):-1!==e.indexOf(".")?(t=Number.parseFloat(e),e=e.replace(/\.?0+$/,"")):t=Number.parseInt(e,10),n&&(t=String(t)===e?t:e)),t}return He.isExist(e)?e:""}const at=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])(.*?)\\3)?","g");function ct(e,t){if(!t.ignoreAttributes&&"string"==typeof e){e=e.replace(/\r?\n/g," ");const n=He.getAllMatches(e,at),r=n.length,i={};for(let e=0;e<r;e++){const r=ot(n[e][1],t);r.length&&(void 0!==n[e][4]?(t.trimValues&&(n[e][4]=n[e][4].trim()),n[e][4]=t.attrValueProcessor(n[e][4],r),i[t.attributeNamePrefix+r]=st(n[e][4],t.parseAttributeValue,t.parseTrueNumberOnly)):t.allowBooleanAttributes&&(i[t.attributeNamePrefix+r]=!0))}if(!Object.keys(i).length)return;if(t.attrNodeName){const e={};return e[t.attrNodeName]=i,e}return i}}function lt(e,t){let n,r="";for(let i=t;i<e.length;i++){let t=e[i];if(n)t===n&&(n="");else if('"'===t||"'"===t)n=t;else{if(">"===t)return{data:r,index:i};"\t"===t&&(t=" ")}r+=t}}function ut(e,t,n,r){const i=e.indexOf(t,n);if(-1===i)throw new Error(r);return i+t.length-1}var dt={defaultOptions:tt,props:rt,getTraversalObj:function(e,t){e=e.replace(/(\r\n)|\n/," "),t=Qe(t,et,nt);const n=new Ke("!xml");let r=n,i="";for(let n=0;n<e.length;n++){if("<"===e[n])if("/"===e[n+1]){const o=ut(e,">",n,"Closing Tag is not closed.");let s=e.substring(n+2,o).trim();if(t.ignoreNameSpace){const e=s.indexOf(":");-1!==e&&(s=s.substr(e+1))}r&&(r.val?r.val=He.getValue(r.val)+""+it(s,i,t):r.val=it(s,i,t)),t.stopNodes.length&&t.stopNodes.includes(r.tagname)&&(r.child=[],null==r.attrsMap&&(r.attrsMap={}),r.val=e.substr(r.startIndex+1,n-r.startIndex-1)),r=r.parent,i="",n=o}else if("?"===e[n+1])n=ut(e,"?>",n,"Pi Tag is not closed.");else if("!--"===e.substr(n+1,3))n=ut(e,"--\x3e",n,"Comment is not closed.");else if("!D"===e.substr(n+1,2)){const t=ut(e,">",n,"DOCTYPE is not closed.");n=e.substring(n,t).indexOf("[")>=0?e.indexOf("]>",n)+1:t}else if("!["===e.substr(n+1,2)){const o=ut(e,"]]>",n,"CDATA is not closed.")-2,s=e.substring(n+9,o);if(i&&(r.val=He.getValue(r.val)+""+it(r.tagname,i,t),i=""),t.cdataTagName){const e=new Ke(t.cdataTagName,r,s);r.addChild(e),r.val=He.getValue(r.val)+t.cdataPositionChar,s&&(e.val=s)}else r.val=(r.val||"")+(s||"");n=o+2}else{const o=lt(e,n+1);let s=o.data;const a=o.index,c=s.indexOf(" ");let l=s;if(-1!==c&&(l=s.substr(0,c).trimRight(),s=s.substr(c+1)),t.ignoreNameSpace){const e=l.indexOf(":");-1!==e&&(l=l.substr(e+1))}if(r&&i&&"!xml"!==r.tagname&&(r.val=He.getValue(r.val)+""+it(r.tagname,i,t)),s.length>0&&s.lastIndexOf("/")===s.length-1){"/"===l[l.length-1]?(l=l.substr(0,l.length-1),s=l):s=s.substr(0,s.length-1);const e=new Ke(l,r,"");l!==s&&(e.attrsMap=ct(s,t)),r.addChild(e)}else{const e=new Ke(l,r);t.stopNodes.length&&t.stopNodes.includes(e.tagname)&&(e.startIndex=a),l!==s&&(e.attrsMap=ct(s,t)),r.addChild(e),r=e}i="",n=a}else i+=e[n]}return n}};const ft={allowBooleanAttributes:!1},ht=["allowBooleanAttributes"];function pt(e,t){for(var n=t;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{var r=e.substr(n,t-n);if(t>5&&"xml"===r)return wt("InvalidXml","XML declaration allowed only at the start of the document.",At(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function gt(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let n=1;for(t+=8;t<e.length;t++)if("<"===e[t])n++;else if(">"===e[t]&&(n--,0===n))break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}function yt(e,t){let n="",r="",i=!1;for(;t<e.length;t++){if('"'===e[t]||"'"===e[t])if(""===r)r=e[t];else{if(r!==e[t])continue;r=""}else if(">"===e[t]&&""===r){i=!0;break}n+=e[t]}return""===r&&{value:n,index:t,tagClosed:i}}const vt=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function mt(e,t){const n=He.getAllMatches(e,vt),r={};for(let i=0;i<n.length;i++){if(0===n[i][1].length)return wt("InvalidAttr","Attribute '"+n[i][2]+"' has no space in starting.",Pt(e,n[i][0]));if(void 0===n[i][3]&&!t.allowBooleanAttributes)return wt("InvalidAttr","boolean attribute '"+n[i][2]+"' is not allowed.",Pt(e,n[i][0]));const o=n[i][2];if(!xt(o))return wt("InvalidAttr","Attribute '"+o+"' is an invalid name.",Pt(e,n[i][0]));if(r.hasOwnProperty(o))return wt("InvalidAttr","Attribute '"+o+"' is repeated.",Pt(e,n[i][0]));r[o]=1}return!0}function bt(e,t){if(";"===e[++t])return-1;if("#"===e[t])return function(e,t){let n=/\d/;for("x"===e[t]&&(t++,n=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(n))break}return-1}(e,++t);let n=0;for(;t<e.length;t++,n++)if(!(e[t].match(/\w/)&&n<20)){if(";"===e[t])break;return-1}return t}function wt(e,t,n){return{err:{code:e,msg:t,line:n}}}function xt(e){return He.isName(e)}function At(e,t){return e.substring(0,t).split(/\r?\n/).length}function Pt(e,t){return e.indexOf(t)+t.length}var Nt=function(e,t){t=He.buildOptions(t,ft,ht);const n=[];let r=!1,i=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(let s=0;s<e.length;s++){if("<"!==e[s]){if(" "===e[s]||"\t"===e[s]||"\n"===e[s]||"\r"===e[s])continue;return wt("InvalidChar","char '"+e[s]+"' is not expected.",At(e,s))}if(s++,"?"===e[s]){if(s=pt(e,++s),s.err)return s}else{if("!"===e[s]){s=gt(e,s);continue}{let a=!1;"/"===e[s]&&(a=!0,s++);let c="";for(;s<e.length&&">"!==e[s]&&" "!==e[s]&&"\t"!==e[s]&&"\n"!==e[s]&&"\r"!==e[s];s++)c+=e[s];if(c=c.trim(),"/"===c[c.length-1]&&(c=c.substring(0,c.length-1),s--),o=c,!He.isName(o)){let t;return t=0===c.trim().length?"There is an unnecessary space between tag name and backward slash '</ ..'.":"Tag '"+c+"' is an invalid name.",wt("InvalidTag",t,At(e,s))}const l=yt(e,s);if(!1===l)return wt("InvalidAttr","Attributes for '"+c+"' have open quote.",At(e,s));let u=l.value;if(s=l.index,"/"===u[u.length-1]){u=u.substring(0,u.length-1);const n=mt(u,t);if(!0!==n)return wt(n.err.code,n.err.msg,At(e,s-u.length+n.err.line));r=!0}else if(a){if(!l.tagClosed)return wt("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",At(e,s));if(u.trim().length>0)return wt("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",At(e,s));{const t=n.pop();if(c!==t)return wt("InvalidTag","Closing tag '"+t+"' is expected inplace of '"+c+"'.",At(e,s));0==n.length&&(i=!0)}}else{const o=mt(u,t);if(!0!==o)return wt(o.err.code,o.err.msg,At(e,s-u.length+o.err.line));if(!0===i)return wt("InvalidXml","Multiple possible root nodes found.",At(e,s));n.push(c),r=!0}for(s++;s<e.length;s++){if("<"===e[s]){if("!"===e[s+1]){s++,s=gt(e,s);continue}break}if("&"===e[s]){const t=bt(e,s);if(-1==t)return wt("InvalidChar","char '&' is not expected.",At(e,s));s=t}}"<"===e[s]&&s--}}}var o;return r?!(n.length>0)||wt("InvalidXml","Invalid '"+JSON.stringify(n,null,4).replace(/\r?\n/g,"")+"' found.",1):wt("InvalidXml","Start tag expected.",1)};const Ot=function(e){return String.fromCharCode(e)},Ct={nilChar:Ot(176),missingChar:Ot(201),nilPremitive:Ot(175),missingPremitive:Ot(200),emptyChar:Ot(178),emptyValue:Ot(177),boundryChar:Ot(179),objStart:Ot(198),arrStart:Ot(204),arrayEnd:Ot(185)},jt=[Ct.nilChar,Ct.nilPremitive,Ct.missingChar,Ct.missingPremitive,Ct.boundryChar,Ct.emptyChar,Ct.emptyValue,Ct.arrayEnd,Ct.objStart,Ct.arrStart],Tt=function(e,t,n){if("string"==typeof t)return e&&e[0]&&void 0!==e[0].val?kt(e[0].val):kt(e);{const i=void 0===(r=e)?Ct.missingChar:null===r?Ct.nilChar:!(r.child&&0===Object.keys(r.child).length&&(!r.attrsMap||0===Object.keys(r.attrsMap).length))||Ct.emptyChar;if(!0===i){let r="";if(Array.isArray(t)){r+=Ct.arrStart;const i=t[0],o=e.length;if("string"==typeof i)for(let t=0;t<o;t++){const n=kt(e[t].val);r=St(r,n)}else for(let t=0;t<o;t++){const o=Tt(e[t],i,n);r=St(r,o)}r+=Ct.arrayEnd}else{r+=Ct.objStart;const i=Object.keys(t);Array.isArray(e)&&(e=e[0]);for(let o in i){const s=i[o];let a;a=!n.ignoreAttributes&&e.attrsMap&&e.attrsMap[s]?Tt(e.attrsMap[s],t[s],n):s===n.textNodeName?Tt(e.val,t[s],n):Tt(e.child[s],t[s],n),r=St(r,a)}}return r}return i}var r},kt=function(e){switch(e){case void 0:return Ct.missingPremitive;case null:return Ct.nilPremitive;case"":return Ct.emptyValue;default:return e}},St=function(e,t){return Et(t[0])||Et(e[e.length-1])||(e+=Ct.boundryChar),e+t},Et=function(e){return-1!==jt.indexOf(e)};const It=He.buildOptions;var _t={convert2nimn:function(e,t,n){return n=It(n,dt.defaultOptions,dt.props),Tt(e,t,n)}};const Vt=He.buildOptions,Ft=function(e,t,n){let r="{";const i=Object.keys(e.child);for(let n=0;n<i.length;n++){var o=i[n];if(e.child[o]&&e.child[o].length>1){for(var s in r+='"'+o+'" : [ ',e.child[o])r+=Ft(e.child[o][s],t)+" , ";r=r.substr(0,r.length-1)+" ] "}else r+='"'+o+'" : '+Ft(e.child[o][0],t)+" ,"}return He.merge(r,e.attrsMap),He.isEmptyObject(r)?He.isExist(e.val)?e.val:"":(He.isExist(e.val)&&("string"!=typeof e.val||""!==e.val&&e.val!==t.cdataPositionChar)&&(r+='"'+t.textNodeName+'" : '+(!0!==(a=e.val)&&!1!==a&&isNaN(a)?'"'+a+'"':a)),","===r[r.length-1]&&(r=r.substr(0,r.length-2)),r+"}");var a};var Mt={convertToJsonString:function(e,t){return(t=Vt(t,dt.defaultOptions,dt.props)).indentBy=t.indentBy||"",Ft(e,t)}};const Dt=He.buildOptions,Rt={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:function(e){return e},attrValueProcessor:function(e){return e}},$t=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor"];function Gt(e){this.options=Dt(e,Rt,$t),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=qt),this.options.cdataTagName?this.isCDATA=Ht:this.isCDATA=function(){return!1},this.replaceCDATAstr=Lt,this.replaceCDATAarr=Bt,this.options.format?(this.indentate=Yt,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=Xt,this.buildObjNode=zt):(this.buildTextNode=Ut,this.buildObjNode=Jt),this.buildTextValNode=Ut,this.buildObjectNode=Jt}function Lt(e,t){return e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e?e+"<![CDATA["+t+"]]"+this.tagEndChar:e.replace(this.options.cdataPositionChar,"<![CDATA["+t+"]]"+this.tagEndChar)}function Bt(e,t){if(e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e)return e+"<![CDATA["+t.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(let n in t)e=e.replace(this.options.cdataPositionChar,"<![CDATA["+t[n]+"]]>");return e+this.newLine}function Jt(e,t,n,r){return n&&!e.includes("<")?this.indentate(r)+"<"+t+n+">"+e+"</"+t+this.tagEndChar:this.indentate(r)+"<"+t+n+this.tagEndChar+e+this.indentate(r)+"</"+t+this.tagEndChar}function zt(e,t,n,r){return""!==e?this.buildObjectNode(e,t,n,r):this.indentate(r)+"<"+t+n+"/"+this.tagEndChar}function Ut(e,t,n,r){return this.indentate(r)+"<"+t+n+">"+this.options.tagValueProcessor(e)+"</"+t+this.tagEndChar}function Xt(e,t,n,r){return""!==e?this.buildTextValNode(e,t,n,r):this.indentate(r)+"<"+t+n+"/"+this.tagEndChar}function Yt(e){return this.options.indentBy.repeat(e)}function qt(e){return!!e.startsWith(this.options.attributeNamePrefix)&&e.substr(this.attrPrefixLen)}function Ht(e){return e===this.options.cdataTagName}Gt.prototype.parse=function(e){return this.j2x(e,0).val},Gt.prototype.j2x=function(e,t){let n="",r="";const i=Object.keys(e),o=i.length;for(let s=0;s<o;s++){const o=i[s];if(void 0===e[o]);else if(null===e[o])r+=this.indentate(t)+"<"+o+"/"+this.tagEndChar;else if(e[o]instanceof Date)r+=this.buildTextNode(e[o],o,"",t);else if("object"!=typeof e[o]){const i=this.isAttribute(o);i?n+=" "+i+'="'+this.options.attrValueProcessor(""+e[o])+'"':this.isCDATA(o)?e[this.options.textNodeName]?r+=this.replaceCDATAstr(e[this.options.textNodeName],e[o]):r+=this.replaceCDATAstr("",e[o]):o===this.options.textNodeName?e[this.options.cdataTagName]||(r+=this.options.tagValueProcessor(""+e[o])):r+=this.buildTextNode(e[o],o,"",t)}else if(Array.isArray(e[o]))if(this.isCDATA(o))r+=this.indentate(t),e[this.options.textNodeName]?r+=this.replaceCDATAarr(e[this.options.textNodeName],e[o]):r+=this.replaceCDATAarr("",e[o]);else{const n=e[o].length;for(let i=0;i<n;i++){const n=e[o][i];if(void 0===n);else if(null===n)r+=this.indentate(t)+"<"+o+"/"+this.tagEndChar;else if("object"==typeof n){const e=this.j2x(n,t+1);r+=this.buildObjNode(e.val,o,e.attrStr,t)}else r+=this.buildTextNode(n,o,"",t)}}else if(this.options.attrNodeName&&o===this.options.attrNodeName){const t=Object.keys(e[o]),r=t.length;for(let i=0;i<r;i++)n+=" "+t[i]+'="'+this.options.attrValueProcessor(""+e[o][t[i]])+'"'}else{const n=this.j2x(e[o],t+1);r+=this.buildObjNode(n.val,o,n.attrStr,t)}}return{attrStr:n,val:r}};var Wt=Gt,Zt=qe((function(e,t){const n=dt,r=He.buildOptions;t.parse=function(e,t,i){if(i){!0===i&&(i={});const t=Nt(e,i);if(!0!==t)throw Error(t.err.msg)}t=r(t,n.defaultOptions,n.props);const o=dt.getTraversalObj(e,t);return Ze.convertToJson(o,t)},t.convertTonimn=_t.convert2nimn,t.getTraversalObj=dt.getTraversalObj,t.convertToJson=Ze.convertToJson,t.convertToJsonString=Mt.convertToJsonString,t.validate=Nt,t.j2xParser=Wt,t.parseToNimn=function(e,n,r){return t.convertTonimn(t.getTraversalObj(e,r),n,r)}}));Zt.parse,Zt.convertTonimn,Zt.getTraversalObj,Zt.convertToJson,Zt.convertToJsonString,Zt.validate,Zt.j2xParser,Zt.parseToNimn;class Kt extends Error{constructor(e=""){super("Cannot assign value to a read-only property. "+e),Object.setPrototypeOf(this,new.target.prototype)}}class Qt extends Error{constructor(e=""){super("Cannot read value on a write-only property. "+e),Object.setPrototypeOf(this,new.target.prototype)}}class en extends Error{constructor(e=""){let t="Invalid Parameters";e&&(t+=": "+e),super(t),Object.setPrototypeOf(this,new.target.prototype)}}class tn extends Error{constructor(e){let t="Not supported on "+(["Source Plugins","Source Property","Extensions"][[f.isSourcePlugin,f.isSourceProps,f.isExtension].indexOf(!0)]||"current environment");e&&(t+=": "+e),super(t),Object.setPrototypeOf(this,new.target.prototype)}}const nn=t=>e(void 0,void 0,void 0,(function*(){return Boolean(Number(yield t.exec("GetGlobalProperty","splitmode")))}));var rn,on,sn=(rn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},function(e){return null==rn?void 0:rn[e]}),an=/&(?:amp|lt|gt|quot|#39);/g,cn=RegExp(an.source);function ln(e="embedded"){if("undefined"==typeof window)return;const t={event:"set-mode",value:e};window.parent.postMessage(JSON.stringify(t),"*")}function un(e){if("undefined"==typeof window)return;const t={event:"set-custom-tabs",value:JSON.stringify(e)};window.parent.postMessage(JSON.stringify(t),"*")}function dn(e){if("undefined"==typeof window)return;const t={event:"set-tab-order",value:JSON.stringify(e)};window.parent.postMessage(JSON.stringify(t),"*")}function fn(e){if("undefined"==typeof window)return;const t={event:"show-overlay",value:!e};window.parent.postMessage(JSON.stringify(t),"*")}!function(e){e.FULL="full",e.TABBED="embedded"}(on||(on={}));const hn={};"undefined"!=typeof window&&void 0===window.OnPropsMessageReceive&&(window.OnPropsMessageReceive=e=>{try{const{key:t,payload:n}=JSON.parse(e);if(void 0===hn[t])return;hn[t].forEach(e=>{"function"==typeof e&&e(n)})}catch(e){console.error("OnPropsMessageReceive is invalid",e.message)}});const pn={configure:function(e){ln(e.mode),un(e.customTabs),dn(e.tabOrder),fn(!0)},resize:function(e,t){if("undefined"==typeof window)return;const n={event:"resize",value:JSON.stringify({width:e,height:t})};window.parent.postMessage(JSON.stringify(n),"*")},setCustomTabs:un,setMode:ln,setTabsOrder:dn,setVisible:fn,emit:function(e,t){if("undefined"==typeof window)return;window.external.CallInner("OnPropsMessageReceive",JSON.stringify({key:e,payload:t}))},on:function(e,t){void 0===hn[e]&&(hn[e]=[]),hn[e].push(t)},off:(e,t)=>{if(void 0===hn[e])return;const n=hn[e].indexOf(t);-1!==n&&delete hn[e][n]}};function gn(e,t){if("object"!=typeof e)return[!1,t];const n=Object.keys(e),r=t.filter(e=>-1===n.indexOf(e));return r.length>0?[!1,r]:[!0,[]]}const yn={keepAspectRatio:{key:"prop:keep_ar",setValidator:e=>{if("boolean"!=typeof e)throw new en(e+" should be a boolean");return!0},setTransformer:e=>e?"1":"0",getTransformer:e=>"1"===e},transparency:{key:"prop:alpha",setValidator:e=>{if("number"!=typeof e)throw new en(e+" should be a number");if(e<0||e>255)throw new Error("Transparency may only be in the range 0-255.");return!0},setTransformer:e=>String(e),getTransformer:e=>parseInt(e)},browser60fps:{key:"prop:Browser60fps",setValidator:e=>{if("boolean"!=typeof e)throw new en(e+" should be a boolean");return!0},setTransformer:e=>e?"1":"0",getTransformer:e=>"1"===e},customName:{key:"prop:cname",setValidator:e=>{if("string"!=typeof e)throw new en(e+" should be a string");return!0}},position:{key:"prop:pos",setValidator:e=>{const[t,n]=gn(e,["left","top","right","bottom"]);if(t)throw new en("Missing keys: "+n.join(", "));return!0},setTransformer:e=>{const t=Object.keys(e).reduce((t,n)=>{const r=Number(e[n])/100;return Object.assign(Object.assign({},t),{[n]:Math.min(Math.max(0,r),1).toFixed(1)})},{});return`${t.left},${t.top},${t.right},${t.bottom}`},getTransformer:e=>{const t=String(e).split(","),n=["left","top","right","bottom"];return t.reduce((e,t,r)=>Object.assign(Object.assign({},e),{[n[r]]:100*Number(t)}),{})}},visibility:{key:"prop:visible",setValidator:e=>{if(e)throw new en(e+" should be a boolean");return!0},setTransformer:e=>e?"1":"0",getTransformer:e=>"1"===e},item:{key:"prop:item"},srcid:{key:"prop:srcid"},type:{key:"prop:type",setValidator:e=>{const[t,n]=gn(e,["type","item"]);if(t)throw new en("Missing keys: "+n.join(", "));return!0},setTransformer:e=>`${e.type},${e.item}`,getTransformer:e=>({0:"undefined",1:"file",2:"live",3:"text",4:"bitmap",5:"screen",6:"flash",7:"games",8:"html",9:"3ds",10:"ppt",11:"scene",12:"group",13:"replay"}[e])},itemList:{key:"itemlist",setValidator:()=>{throw new Kt("Setting itemlist is not supported")},setTransformer:()=>{throw new Kt("Setting itemlist is not supported")},getTransformer:e=>String(e).split(",")},fileInfo:{key:"FileInfo",setValidator:()=>{throw new Kt("Setting FileInfo is not supported")}}},vn={scenes:{key:"sceneconfig",setValidator:e=>{if("string"!=typeof e)throw new Error("Parameter should be a string");return!0}},sceneIndex:{key:"scene:${view}",setValidator:e=>{const[t,n]=gn(e,["value","view"]);if(!t)throw new en("Missing keys: "+n.join(", "));return!0},setTransformer:e=>String(e.value),getValidator:e=>{const[t,n]=gn(e,["view"]);if(!t)throw new en("Missing keys: "+n.join(", "));return!0},getTransformer:e=>Number(e)},scenePreset:{key:"scenepreset:${scene}",setValidator:e=>{const[t,n]=gn(e,["value","scene"]);if(!t)throw new en("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new tn;return!0},setTransformer:e=>e.value,getValidator:e=>{const[t,n]=gn(e,["scene"]);if(!t)throw new en("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new tn;return!0}},scenePresetList:{key:"scenepresetlist:${scene}",setValidator:()=>{throw new Kt},getValidator:e=>{const[t,n]=gn(e,["scene"]);if(!t)throw new en("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new tn;return!0},getTransformer:e=>["{00000000-0000-0000-0000-000000000000}",...String(e).split(",").filter(Boolean)]},sceneNewPreset:{key:"scenenewpreset:${scene}",setValidator:()=>{throw new Kt},getValidator:e=>{const[t,n]=gn(e,["scene"]);if(!t)throw new en("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new tn;return!0}},sceneRemovePreset:{key:"sceneremovepreset:${scene}",setValidator:e=>{const[t,n]=gn(e,["scene","value"]);if(!t)throw new en("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new tn;return!0},setTransformer:e=>e.value,getValidator:()=>{throw new Qt}},scenePresetTransition:{key:"scenepresettransitionfunc:${scene}",setValidator:e=>{const[t,n]=gn(e,["scene","value"]);if(!t)throw new en("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new tn;return!0},setTransformer:e=>"none"===e.value?"":e.value,getValidator:e=>{const[t,n]=gn(e,["scene"]);if(!t)throw new en("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new tn;return!0},getTransformer:e=>""===e?"none":e},scenePresetTransitionTime:{key:"scenepresettransitiontime:${scene}",setValidator:e=>{const[t,n]=gn(e,["scene","value"]);if(!t)throw new en("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new tn;return!0},setTransformer:e=>String(e.value),getValidator:e=>{const[t,n]=gn(e,["scene","value"]);if(!t)throw new en("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new tn;return!0},getTransformer:e=>Number(e)},microphoneDev2:{key:"microphonedev2",setValidator:e=>{if("string"!=typeof e)throw new Error("Parameter should be a string");return!0}},wasapiEnum:{key:"wasapienum",setValidator:e=>{if("string"!=typeof e)throw new Error("Parameter should be a string");return!0}},sceneItems:{key:"sceneconfig:${scene}",setValidator:e=>{const[t,n]=gn(e,["scene","value"]);if(!t)throw new en("Missing keys: "+n.join(", "));return!0},setTransformer:e=>e.value,getValidator:e=>{const[t,n]=gn(e,["scene"]);if(!t)throw new en("Missing keys: "+n.join(", "));return!0}},sceneName:{key:"scenename:${scene}",setValidator:e=>{const[t,n]=gn(e,["value","scene"]);if(!t)throw new en("Missing keys: "+n.join(", "));return!0},setTransformer:e=>e.value,getValidator:e=>{const[t,n]=gn(e,["scene"]);if(!t)throw new en("Missing keys: "+n.join(", "));return!0}},sceneThumbnail:{key:"sceneshot:${scene}:${width},${height}",setValidator:()=>{throw new Kt},getValidator:e=>{const[t,n]=gn(e,["scene","width","height"]);if(!t)throw new en("Missing keys: "+n.join(", "));return!0}},audioDevices:{},audioDevicesWASAPI:{}};vn.audioDevices=vn.microphoneDev2,vn.audioDevicesWASAPI=vn.wasapiEnum;class mn{constructor(e){return new Ue(e)}}return mn.XjsTypes=s,mn.App=class{constructor(e){this.internal=e.internal}setProperty(e,t){if("function"!=typeof e.setValidator||e.setValidator(t)){let n=e.key,r=t;if("object"==typeof t){const i=Object.assign({},t);n=Xe(e.key,i,!0),r="function"==typeof e.setTransformer?e.setTransformer(i):String(i.value)}else r="function"==typeof e.setTransformer?e.setTransformer(t):String(t);return this.internal.exec("AppSetPropertyAsync",n,r)}throw new Error(`Params "${t}" validation failed`)}getProperty(t,n){return e(this,void 0,void 0,(function*(){if("function"!=typeof t.getValidator||t.getValidator(n)){const e=Xe(t.key,n||{}),r=yield this.internal.exec("AppGetPropertyAsync",e);return"function"==typeof t.getTransformer?t.getTransformer(r):r}throw new Error(`Params "${n}" validation failed`)}))}},mn.Events=class{constructor(t,n){this.callbacks={},this.xjs=t,this.instances=n||[],Je({SetEvent:t=>e(this,void 0,void 0,(function*(){const{event:n,info:r}=t.split("&").reduce((e,t)=>{const[n,r]=t.split("=");return Object.assign(Object.assign({},e),{[n]:r})},{});const i=yield Ye(this.instances,(t,i)=>e(this,void 0,void 0,(function*(){return t!==r?t:"function"==typeof i.eventsHandler?i.eventsHandler(n,r):r})),r);Array.isArray(this.callbacks[n])&&this.callbacks[n].forEach(e=>{"function"==typeof e&&e(decodeURIComponent(i))})})),AppOnEvent:(t,...n)=>e(this,void 0,void 0,(function*(){const r=yield Ye(this.instances,(t,r)=>e(this,void 0,void 0,(function*(){return"function"==typeof r.eventsHandler?r.eventsHandler(event,...n):t})));Array.isArray(this.callbacks[t])&&this.callbacks[t].forEach(e=>{if("function"==typeof e){e(...r?[r]:n)}})}))})}on(e,t){this.callbacks[e]=this.callbacks[e]?[...this.callbacks[e],t]:[t]}off(e){delete this.callbacks[e]}},mn.Item=class{constructor(e){this.internal=e.internal}getPlacements(){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("AppGetPropertyAsync","sceneconfig"),t=Zt.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1});return t&&t.configuration&&t.configuration.placement||[]}))}isCurrentItem(t){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("GetLocalPropertyAsync","prop:srcid");return t===e}))}getLinkedItem(t){return e(this,void 0,void 0,(function*(){const e=yield this.getItemList(t);return e.length>0?e[0]:""}))}getItemList(t){return e(this,void 0,void 0,(function*(){return(yield this.getPlacements()).reduce((e,n)=>{const r=n.item||[];return[...e,...(Array.isArray(r)?r:[r]).filter(e=>e.srcid===t).map(e=>e.id)]},[])}))}getCurrentItem(){return e(this,void 0,void 0,(function*(){if(f.isExtension)throw new Error("You cannot use `getCurrentItem` in an extension plugin");const e=yield this.internal.exec("GetLocalPropertyAsync","itemlist"),t=yield this.internal.exec("GetLocalPropertyAsync","prop:srcid"),n=e.split(",");if(0===n.length)throw new Error("Cannot get current item, itemlist did not return any ID");return{srcid:t,id:n[0]}}))}setProperty(t,n){return e(this,void 0,void 0,(function*(){if(void 0===n.id||void 0===n.srcid)throw new en("param should be an object with an `id` and `srcid` property");if("function"!=typeof t.setValidator||t.setValidator(n.value)){const e=f.isSourcePlugin?"AttachVideoItem1":"SearchVideoItem",r=f.isSourcePlugin?"SetLocalPropertyAsync1":"SetLocalPropertyAsync";this.internal.exec(e,n.id);const i=yield this.internal.exec(r,t.key,"function"!=typeof t.setTransformer?n.value:t.setTransformer(n.value));if(isNaN(i)||!(Number(i)<0))return i;{console.warn("Attached item does not exist. Attempting to attach linked item...");const e=yield this.getLinkedItem(n.srcid);if(e)return this.setProperty(t,Object.assign(Object.assign({},n),{id:e}));console.error("Failed to find linked item.")}}throw new en(`Params "${n}" validation failed`)}))}getProperty(t,n){return e(this,void 0,void 0,(function*(){if(void 0===n.id||void 0===n.srcid)throw new en("param should be an object with an `id` and `srcid` property");if("function"!=typeof t.getValidator||t.getValidator(n.value)){const e=f.isSourcePlugin?"AttachVideoItem1":"SearchVideoItem",r=f.isSourcePlugin?"GetLocalPropertyAsync1":"GetLocalPropertyAsync";this.internal.exec(e,n.id);const i=yield this.internal.exec(r,t.key);if(null!==i&&"null"!==i)return"function"!=typeof t.getTransformer?i:t.getTransformer(i);{console.warn("Attached item does not exaist. Attempting to attach linked item...");const e=yield this.getLinkedItem(n.srcid);if(e)return this.getProperty(t,Object.assign(Object.assign({},n),{id:e}));console.error("Failed to find linked item.")}}throw new en(`Params "${n}" validation failed`)}))}setConfiguration(e,t){if(!f.isSourcePlugin)throw new Error("You can only set configuration in source plugins");if(!this.isCurrentItem(t.srcid))throw new Error("You can only set configuration for the current item");this.internal.exec("SetBrowserProperty","Configuration",JSON.stringify(e))}getConfiguration(t){return e(this,void 0,void 0,(function*(){if(f.isExtension)throw new Error("You cannot set configuration in extension plugins");if(!this.isCurrentItem(t.srcid))throw new Error("You can only get configuration for the current item");let e=yield this.internal.exec("GetLocalPropertyAsync","prop:BrowserConfiguration");return e&&"null"!==e||(e=yield this.internal.exec("GetConfiguration")),JSON.parse(e||"{}")}))}},mn.Preset=class{constructor({internal:e}){this.internal=e}listAll(t){return e(this,void 0,void 0,(function*(){return["{00000000-0000-0000-0000-000000000000}",...(yield this.internal.exec("AppGetPropertyAsync","scenepresetlist:"+t)).split(",").filter(Boolean)]}))}getActive(t){return e(this,void 0,void 0,(function*(){return yield this.internal.exec("AppGetProperty","scenepreset:"+t)}))}setActive(t,n){return e(this,void 0,void 0,(function*(){return yield this.internal.exec("AppSetPropertyAsync","scenepreset:"+t,n),!0}))}},mn.Remote=Le,mn.Scene=class{constructor({internal:e}){this.internal=e}getByIndex(t){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("AppGetPropertyAsync","sceneconfig:"+t),n=Zt.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1}),{placement:r}=n;return{index:t,id:r.id,name:r.name}}))}getById(t){return e(this,void 0,void 0,(function*(){return(yield this.listAll()).find(e=>e.id===t)||Promise.reject(`Scene with id: ${t} not found`)}))}getActive(){return e(this,void 0,void 0,(function*(){if(yield nn(this.internal)){const e=decodeURIComponent(yield this.internal.exec("AppGetPropertyAsync","sceneid:i12"));return this.getById(e)}const e=Number(yield this.internal.exec("AppGetPropertyAsync","scene:0"));return this.getByIndex(e)}))}setActive(t){return e(this,void 0,void 0,(function*(){return(yield nn(this.internal))?(yield this.internal.exec("AppSetPropertyAsync","scene:1",String(t)),yield this.internal.exec("CallHostFunc","goLive"),!0):(yield this.internal.exec("AppSetPropertyAsync","scene:0",String(t)),!0)}))}setName(t,n){return e(this,void 0,void 0,(function*(){return yield this.internal.exec("AppSetPropertyAsync","scenename:"+t,n),!0}))}listAll(){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("AppGetPropertyAsync","sceneconfig"),t=Zt.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1}),{configuration:{placement:n}}=t;return Array.isArray(n)?n.map((e,t)=>({id:e.id,index:t,name:e.name})):"object"==typeof n?[{id:n.id,index:0,name:n.name}]:[]}))}getItems(t){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("AppGetPropertyAsync","sceneconfig:"+t),n=Zt.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1});return(Array.isArray(n.placement.item)?n.placement.item:[n.placement.item]).map(({id:e,srcid:t,name:n})=>{return{id:e,srcid:t,name:(r=n,(r=le(r))&&cn.test(r)?r.replace(an,sn):r)};var r})}))}},mn.SourceProperty=pn,mn.View=class{constructor(e){this.internal=e.internal}getCurrentSceneIndex(t){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("AppGetPropertyAsync","scene:"+t),n=yield this.internal.exec("AppGetPropertyAsync","scene:"+e);return Number(n)}))}isSplitMode(){return e(this,void 0,void 0,(function*(){return Boolean(Number(yield this.internal.exec("GetGlobalProperty","splitmode")))}))}},mn.ItemProps=yn,mn.AppProps=vn,mn.version=Ue.version,mn}));
